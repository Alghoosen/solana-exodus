---
title: قائد بلا بنك (Bankless Leader)
---

يقوم القائد بلا بنك (Bankless Leader) بالحد الأدنى من العمل لإنتاج كتلة (block) صالحة. يُكلف القائد بإدخال المُعاملات، فرز المُعاملات الصالحة وتصفيتها، ترتيبها في مُدخلات (entries)، تمزيق المُدخلات، وبث الأشلاء (shreds). بينما يحتاج المُدقّق (validator) فقط إلى إعادة تجميع الكتلة (block) وإعادة تنفيذ المُدخلات (entries) المُصممة جيدًا. يقوم القائد بإجراء عمليات ذاكرة أكثر بثلاث مرات (3x) قبل تنفيذ أي بنك أكثر من المُدقّق (validator) لكل مُعاملة تمت مُعالجتها.

## الأساس المنطقي (Rationale)

تتطلب العملية المصرفية العادية للإنفاق القيام بحِملين (loads 2) ومتجرين (2 stores). مع هذا التصميم الرائد يقوم بحِمل (load 1) واحد فقط. لذا فإن عمل account_db أقل بمقدار مرات (4x) قبل إنشاء الكتلة (block). من المُحتمل أن تكون عمليات المتجر (store) أكثر تكلفة من عمليات القراءة.

عندما تبدأ مرحلة إعادة التشغيل في مُعالجة نفس المُعاملات، يُمكن أن تفترض أن الـ PoH صالح، وأن جميع المُدخلات (entries) آمنة للتنفيذ المُتوازي. من المُحتمل أن تظل حسابات الرسوم التي تم تحميلها لإنتاج الكتلة (block) في الذاكرة، لذلك يجب أن يكون الحِمل (load) الإضافي دافئًا ومن المُرجح أن يتم إستهلاك التكلفة.

## حساب الرسوم (Fee Account)

يدفع حساب الرسوم [fee account](../terminology.md#fee_account) المُعاملة ليتم تضمينها في الكتلة (block). يحتاج القائد فقط إلى التحقق من أن حساب الرسوم لديه رصيد لدفع الرسوم.

## التخزين المُؤقت للرصيد (Balance Cache)

طوال فترة الكتل (blocks) المُتتالية للقادة (leaders)، يحتفظ القائد بمخزن مُؤقت للرصيد لجميع حسابات الرسوم التي تمت مُعالجتها. ذاكرة التخزين المُؤقت (cache) هي خريطة من المفاتيح العمومية (pubkeys) إلى الـ lamports.

في بداية الكتلة (block) الأولى، تكون ذاكرة التخزين المُؤقت (cache) للرصيد فارغة. في نهاية الكتلة (block) الأخيرة يتم إتلاف ذاكرة التخزين المُؤقت (cache).

يجب أن تُشير عمليات البحث عن ذاكرة التخزين المُؤقت (cache) للرصيد إلى نفس الإنقسام أو الشوكة (fork) الأساسية طوال مُدة ذاكرة التخزين المُؤقت. عند حدود الكتلة (block)، يمكن إعادة تعيين ذاكرة التخزين المُؤقت (cache) مع إنقسام أو شوكة (fork) القاعدة بعد إنتهاء مرحلة إعادة التشغيل للتحقق من الكتلة السابقة.

## التحقق من الرصيد (Balance Check)

قبل التحقق من الرصيد، يتحقق القائد (leader) من صحة جميع التوقيعات في المُعاملة.

1. تحقق من أن الحسابات ليست قيد الإستخدام وأن تجزئة الكتلة (Blockhash) صالحة.
2. تحقق مما إذا كان حساب الرسوم موجودًا في ذاكرة التخزين المُؤقت (cache)، أو قم بتحميل الحساب من accounts_db وقم بتخزين رصيد الـ lamport في ذاكرة التخزين المُؤقت.
3. إذا كان الرصيد أقل من الرسوم، قُم بإسقاط المُعاملة.
4. إطرح الرسوم من الرصيد.
5. بالنسبة لجميع المفاتيح الموجودة في المُعاملة والتي هي "دائن - مدين" (Credit-Debit) والمُشار إليها بواسطة تعليمات، قُم بتقليل رصيدها إلى 0 في ذاكرة التخزين المُؤقت (cache). يتم الإعلان عن رسوم الحساب كـ"دائن - مدين" (Credit-Debit)، ولكن طالما لم يتم إستخدامها في أي تعليمات، فلن يتم تخفيض رصيدها إلى 0.

## قائد إعادة العرض (Leader Replay)

سيحتاج القادة (Leaders) إلى إعادة تشغيل الكتل (blocks) الخاصة بهم كجزء من عملية مرحلة الإعادة القياسية.

## قائد إعادة العرض مع كتل مُتتالية (Leader Replay With Consecutive Blocks)

يُمكن جدولة القائد لإنتاج كتل (blocks) مُتعددة في صف واحد. في هذا السيناريو، من المُحتمل أن يقوم القائد بإنتاج الكتلة (block) التالية أثناء لعب مرحلة إعادة التشغيل للكتلة الأولى.

عندما ينتهي القائد من مرحلة إعادة التشغيل، يُمكنه إعادة ضبط توازن ذاكرة التخزين المُؤقت (cache) عن طريق مسحها، وتعيين إنقسام أو شوكة (fork) جديدة كأساس لذاكرة التخزين المُؤقت التي يُمكن أن تُصبح نشطة في الكتلة (block) التالية.

## إعادة تعيين ذاكرة التخزين المُؤقت للرصيد (Reseting the Balance Cache)

1. في بداية الكتلة (block)، إذا كانت ذاكرة التخزين المُؤقت للرصيد غير مُهيأة ، فقُم بتعيين الإنقسام أو الشوكة (fork) الأساسية لذاكرة التخزين المُؤقت للرصيد لتكون أصل الكتلة (block) وإنشاء ذاكرة تخزين مُؤقت فارغة.
2. إذا تمت تهيئة ذاكرة التخزين المُؤقت، فتحقق مما إذا كان لدى والدي (parents) الكتلة بنكًا مُجمدًا جديدًا أحدث من إنقسام أو شوكة (fork) القاعدة الحالية لذاكرة التخزين المُؤقت للرصيد.
3. إذا كان هناك أصل (parent) أحدث من الإنقسام الأساسي لذاكرة التخزين المُؤقت (cache)، فقُم بإعادة تعيين ذاكرة التخزين المُؤقت إلى الأصل.

## التأثير على العملاء (Impact on Clients)

يُمكن إعادة إستخدام حساب الرسوم نفسه عدة مرات في نفس الكتلة (block) حتى يتم إستخدامه مرة واحدة كـ"دائن - مدين" (Credit-Debit) من خلال تعليمات.

يجب على العملاء الذين ينقلون عددًا كبيرًا من المُعاملات في الثانية الواحدة إستخدام حساب رسوم مُخصص لا يتم إستخدامه ك"دائن - مدين" (Credit-Debit) في أي تعليمات.

بمجرد إستخدام رسوم الحساب كـ" دائن - مدين" (Credit-Debit)، ستفشل في التحقق من الرصيد حتى يتم إعادة تعيين ذاكرة التخزين المُؤقت (cache) للرصيد.
