---
title: المُدقّق (validator)
---

## التاريخ (History)

عندما بدأنا Solana لأول مرة، كان الهدف هو التخلص من مخاطر مُطالبات عدد المُعاملات في الثانية الواحدة (TPS). كنا نعلم أنه بين التحكم المُتفائل في التزامن وفُتحات القائد (leader slots) الطويلة بما فيه الكفاية، لم يكن إجماع PoS هو الخطر الأكبر على عدد المُعاملات في الثانية الواحدة (TPS). لقد كان التحقق من التوقيع المُستند إلى وحدة مُعالجة الرسومات (GPU-based signature)، وتوجيه البرامج، والخدمات المصرفية المُتزامنة. وهكذا، تم إنشاء وحدة TPU. بعد تجاوز 100 ألف مُعاملة في الثانية الواحدة (100k TPS)، قُمنا بتقسيم الفريق إلى مجموعة واحدة تعمل نحو 710 ألف مُعاملة في الثانية الواحدة (710k TPS) ومجموعة أخرى لتجسيد خط أنابيب المُدقّق (validator pipeline). ومن ثم، ولدت TVU. الهيكل الحالي هو نتيجة للتطوير التدريجي مع هذا الترتيب وأولويات المشروع. إنه ليس إنعكاسًا لما إعتقدنا أنه المقطع العرضي الأكثر أناقة من الناحية الفنية من تلك التقنيات. في سياق تناوب القائد (leader rotation)، يكون التمييز القوي بين القيادة (leading) والمُصادقة (validating) غير واضحان.

## الفرق بين المُصادقة و القيادة (Difference between validating and leading)

الفرق الأساسي بين خطوط الأنابيب (pipelines) هو عندما يكون الـ PoH موجودًا. في القائد، نقوم بمُعالجة المُعاملات، وإزالة السيئ منها، ثم وضع علامة PoH hash على النتيجة. في المُدقّق (validator)، نتحقق من التجزئة (hash) ونقشرها ونُعالج المُعاملات بنفس الطريقة تمامًا. الإختلاف الوحيد هو أنه إذا رأى المُدقّق (validator) مُعاملة سيئة، فلا يُمكنه إزالتها ببساطة كما يفعل القائد (leader)، لأن ذلك قد يتسبب في تغيير تجزئة الـ PoH hash. بدلاً من ذلك، يُرفض الكتلة (block) بأكملها. الفرق الآخر بين خطوط الأنابيب (pipelines) هو ما يحدث بعد _after_ الـ banking. يبث القائد (leader) المُدخلات (entries) إلى المُدقّقين (validators) المُتلقين للمعلومات بينما يكون المُدقّق قد فعل ذلك بالفعل في إعادة الإرسال (RetransmitStage)، وهو تحسين وقت التأكيد. من ناحية أخرى، فإن خط أنابيب المُصادقة (validation pipeline) له خطوة أخيرة. في أي وقت تنتهي فيه من ممُعالجة كتلة (block)، يجب أن تزن أي إنقسامات أو شوكات (forks) تُراقبها، وربما تدلي بصوت، وإذا كان الأمر كذلك، فقُم بإعادة تعيين تجزئة PoH إلى تجزئة الكتلة (block hash) التي صوّت عليها للتو.

## التصميم المُقترح (Proposed Design)

نقوم بفك غلاف العديد من طبقات التجريد وبناء خط أنابيب (pipeline) واحد يُمكنه تبديل وضع القائد (leader) كلما ظهر مُعرف المُدقّق (validator ID) في جدول القائد (leader schedule).

![مُخطط كتلة المُدقّق (Validator block diagram)](/img/validator-proposal.svg)

## تغييرات ملحوظة (Notable changes)

- مرحلة إحضار الرافعة (FetchStage) ومرحلة البث (BroadcastStage) خارج الـ TPU
- تمت إعادة تسمية إنقسامات أو شوكات البنك (BankForks) إلى شجرة البنك (Banktree)
- ينتقل TPU إلى صندوق جديد بدون مِقبس (socket-free) يُسمى solana-tpu.
- تمتص مرحلة الخدمات المصرفية (BankingStage) من الـ TPU مرحلة إعادة التشغيل (ReplayStage)
- يذهب الـ TVU بعيدا
- تمتص مرحلة الإصلاح (RepairStage) الجديدة مرحلة إحضار الشضية (Stage Shred Fetch) وطلبات الإصلاح
- خدمة JSON RPC إختيارية - تستخدم لتصحيح الأخطاء. يجب أن يكون بدلاً من ذلك جزءًا من ملف مُنفصل قابل للتنفيذ `solana-blockstreamer`.
- تمتص مرحلة الإرسال المُتعدد (MulticastStage) الجديدة جزءًا من إعادة إرسال إعادة الإرسال (RetransmitStage)
- مرحلة الإرسال المُتعدد (MulticastStage) مصب لمخزن الكتلة (blockstore)
