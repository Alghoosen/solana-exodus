---
title: التحقق من وضع علامة (Tick Verification)
---

يُصمم هذا المعايير والتحقق من صحة العلامات (ticks) في الفُتحة (Slot). كما يصف أيضًا مُعالجة الأخطاء وشروط الإقتطاع (slashing) التي تشمل كيفية مُعالجة النظام لعمليات الإرسال التي لا تفي بهذه المُتطلبات.

# هيكل الفُتحة (Slot structure)

يجب أن تحتوي كل فُتحة (Slot) على عدد مُتوقع قدره `ticks_per_slot` من العلامات (ticks). يجب أن تتحوي آخر قِطَعة (Shred) في الفُتحة (Slot) على كامل آخر علامة (tick) فقط، ولا شيء آخر. يجب على القائد أيضًا وضع علامة (tick) على هذه القِطَعة (Shred) التي تحتوي على آخر علامة (tick) بعلامة علم `LAST_SHRED_IN_SLOT`. بين العلامة (tick)، يجب أن يكون هناك `hashes_per_tick` عدد من التجزئات (hashes).

# التعامل مع الإرسال السيئ (Handling bad transmissions)

يتم التعامل مع عمليات الإرسال الضارة `T` بطريقتين:

1. إذا كان بإمكان القائد إنشاء بعض الإرسال الخاطئ `T` وأيضًا بعض الإرسال البديل `T'` لنفس الفُتحة (Slot) دون إنتهاك أي قواعد الإقتطاع (slashing) للإرسال المُكرر (على سبيل المثال إذا كان `T'` مجموعة فرعية من `T`)، فيجب على المجموعة (cluster) التعامل مع إمكانية وجود كلا الإرسالين.

بالتالي هذا يعني أنه لا يُمكننا وضع علامة على الإرسال الخاطئ `T` كميت لأن الكتلة (cluster) ربما وصلت إلى إجماع (consensus) على `T'`. هذه الحالات تتطلب حجة قاطعة لمُعاقبة هذا السلوك السيئ.

2. خلاف ذلك، يُمكننا ببساطة تمييز الفُتحة (Slot) على أنها ميتة وغير قابلة للتشغيل. قد يكون إثبات الإقتطاع (slashing proof) ضروريًا وقد لا يكون ضروريًا إعتمادًا على الجدوى.

# مخزن الكتلة يتلقى قِطَعا (Blockstore receiving shreds)

عندما يتلقى مخزن الكتلة (blockstore) قِطَعة (Shred) جديدة `s`، هناك حالتان:

1. تم وضع علامة على `s` كـ `LAST_SHRED_IN_SLOT`، ثم تحقق مما إذا كان هناك `s'` قِطَعة (Shred) في مخزن الكتلة (blockstore) لتلك الفُتحة (Slot) حيث `s'.index > s.index` إذا كان الأمر كذلك، فإن `s` و `s'` معًا يُشكلان دليلًا على إثبات الإقتطاع (slashing proof).

2. تلقى مخزن الكتلة (blockstore) بالفعل `s'` تم تمييزه على أنه آخر قِطَعة (shred) في الفُتحة `LAST_SHRED_IN_SLOT` مع مُؤشر `i`. إذا كان `s.index > i`، فإن `s` و `s'` معًا يُشكلان دليلًا على دليل الإقتطاع (slashing proof). في هذه الحالة، لن يقوم مخزن الكتلة (blockstore) أيضًا بإدراج `s`.

3. يتم تجاهل القِطَع (shreds) المُكررة لنفس الفهرس. القِطَع (shreds) غير المُكررة لنفس الفهرس قابلة للإقتطاع (slashable). يتم تغطية تفاصيل هذه الحالة في قسم قائد كتلة الإقتطاع المُكررة `Leader Duplicate Block Slashing`.

# إعادة التشغيل والتَحَقُّق من صحة العلامات (Replaying and validating ticks)

1. تقوم مرحلة إعادة التشغيل بإعادة المُدخلات (entries) من مخزن الكتلة (blockstore)، وتتبع عدد العلامات (ticks) التي شاهدتها في كل فُتحة (Slot)، والتحقق من وجود `hashes_per_tick` عدد من التجزئة (hashes) بين العلامات. بعد العلامة (tick) للشظية (Shred) الأخيرة، تقوم مرحلة إعادة التشغيل بفحص العدد الإجمالي للعلامات (ticks).

سيناريو الفشل 1: في حالة وجود علامتين (ticks) مُتتاليتين بينهما عدد التجزئات`!= hashes_per_tick`، ضع علامة على هذه الفُتحة (Slot) على أنها ميتة.

سيناريو الفشل 2: إذا كان عدد العلامات != `ticks_per_slot`، ضع علامة على الفُتحة (Slot) على أنها ميتة.

سيناريو الفشل 3: إذا وصل عدد العلامات (ticks) إلى `ticks_per_slot`، لكننا لم نر الرقم `LAST_SHRED_IN_SLOT` بعد، فقُم بتمييز هذه الفُتحة (Slot) على أنها ميتة.

2. عندما تصل ReplayStage إلى قطعة تم تمييزها على أنها آخر قِطَعة (Shred)، فإنها تتحقق مما إذا كانت هذه القطعة الأخيرة عبارة عن علامة (tick).

سيناريو الفشل: إذا تعذر إلغاء تسلسل الشظية (Shred) المُوَقَّة بعلامة `LAST_SHRED_IN_SLOT` لا يمكن إلغاء تسلسلها إلى علامة (إما فشل في إلغاء التسلسل أو إلغاء التسلسل في مُدخل)، ضع علامة على هذه الفُتحة (Slot) على أنها ميتة.
