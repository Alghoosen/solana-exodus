---
title: رسوم المُعاملات الحتمية (Deterministic Transaction Fees)
---

تتضمن المُعاملات حاليًا حقل الرسوم الذي يُشير إلى حقل الحد الأقصى للرسوم الذي يُسمح لقائد الفُتحة (slot leader) بتحصيله لمُعالجة المُعاملة. من ناحية أخرى، تُوافق المجموعة (cluster) على حد أدنى للرسوم. إذا كانت الشبكة مُزدحمة، فقد يعطي قائد الفُتحة (slot leader) الأولوية للمُعاملات التي تُقدم رسومًا أعلى. هذا يعني أن العميل لن يعرف المبلغ الذي تم تحصيله حتى يتم تأكيد المُعاملة من قبل المجموعة (cluster) ويتم فحص الرصيد المُتبقي. إنها تبدو بالضبط ما مثل ما نكرهه في "غاز" الـ Ethereum، اللا حتمية.

## الرسوم المدفوعة بالإزدحام (Congestion-driven fees)

يستخدم كل مُدقّق التوقيعات لكل فتحة _signatures per slot_\ (SPS \) لتقدير إزدحام الشبكة و _SPS target_ لتقدير سعة المُعالجة المطلوبة للمجموعة (cluster). يتعرف المُدقّق (validator) على هدف SPS منذ إعدادات مرحلة التكوين (genesis config)، بينما يحسب SPS من المُعاملات التي تمت مُعالجتها مُؤخرًا. يُحدد التكوين الأصلي أيضًا هدف `lamports_per_signature`، وهو الرسوم التي يتم تحصيلها لكل توقيع عندما تعمل المجموعة عند _SPS target_.

## حساب الرسوم (Calculating fees)

يستخدم العميل واجهة برمجة تطبيقات JSON RPC للإستعلام عن مُعلِّمات (parameters) الرسوم الحالية في المجموعة (cluster). يتم تمييز هذه مُعلِّمات (parameters) بإستخدام تجزئة الكتلة (Blockhash) وتظل صالحة حتى تصبح تجزئة الكتلة قديمة بدرجة كافية ليتم رفضها من قِبل قائد الفُتحة (slot leader).

قبل إرسال مُعاملة إلى الكتلة (cluster)، يجوز للعميل إرسال بيانات حساب المُعاملة والرسوم إلى وحدة SDK تسمى حاسبة الرسوم _fee calculator_. طالما أن إصدار SDK الخاص بالعميل يتطابق مع إصدار قائد الفُتحة (slot leader)، فإن العميل مُطمئن إلى أنه سيتم تغيير حسابه تمامًا بنفس عدد الـ lamports كما تم إرجاعه بواسطة حاسبة الرسوم.

## مُعلِّمات الرسوم (Fee Parameters)

في أول تنفيذ لهذا التصميم، تكون مُعلِّمة (parameter) الرسوم الوحيدة هي ` lamports_per_signature `. كلما زاد عدد التوقيعات التي تحتاج المجموعة (cluster) للتحقق منها، زادت الرسوم. يتم تحديد العدد الدقيق للمنافذ عن طريق نسبة الـ SPS إلى هدف الـ SPS. في نهاية كل فُتحة (Slot)، تُخفض المجموعة `lamports_per_signature` عندما يكون SPS أقل من الهدف وترفعه عندما يكون فوق الهدف. الحد الأدنى لقيمة `lamports_per_signature` هو 50٪ من الهدف `lamports_per_signature` والقيمة القصوى هي 10x للهدف \ "lamports_per_signature"

قد تتضمن المُعلِّمات (parameters) المُستقبلية ما يلي:

- `lamports_per_pubkey` - تكلفة تحميل الحساب
- `lamports_per_slot_distance` - تكلفة أعلى لتحميل حسابات قديمة جدًا
- `lamports_per_byte` - التكلفة لكل حجم حساب تم تحميله
- `lamports_per_bpf_instruction` - تكلفة تشغيل برنامج

## الهجمات (Attacks)

### إختطاف هدف SPS أو Hijacking the SPS Target

يُمكن لمجموعة من المُدقّقين (validators) جعل المجموعة (cluster) مركزية إذا تمكنوا من إقناعها برفع هدف SPS فوق نقطة يتُمكن بقية المُدقّقين من مُواكبة ذلك. سيُؤدي رفع الهدف إلى إنخفاض الرسوم، مما يُؤدي على الأرجح إلى زيادة الطلب وبالتالي زيادة عدد المُعاملات في الثانىة الواحدة (TPS). إذا لم يكن لدى المُدقّق (validator) أجهزة يُمكنها مُعالجة العديد من المُعاملات بهذه السرعة، فستستغرق أصوات التأكيد في النهاية وقتًا طويلاً بحيث تضطر المجموعة (cluster) إلى تشغيلها.
