---
title: الإنتقال من القائد إلى المُدقّق (Leader-to-Validator Transition)
---

عادةً ما يقضي المُدقّق (validator) وقته في التحقق من صحة الكتل (blocks). مع ذلك، إذا قام صاحب الحساب بتفويض حِصّته (stake) إلى مُدقّق (validator) ما، فسيتم تحديده أحيانًا على أنه _slot leader_. بصفته قائد فُتحة (Slot)، يكون المُدقّق (validator) مسؤولاً عن إنتاج الكتل (blocks) خلال فُتحة _slot_. مُعينة. الفترة الزمنية لها عدد مُعين من العلامات _ticks_ المُعدلة مُسبقًا (preconfigured). يتم تقدير مُدة هذه العلامات (ticks) بـ _PoH Recorder_ موصوفة لاحقًا في هذا المُستند.

## إنقسام أو شوكة البنك (BankFork)

يتتبع إنقسام أو شوكة البنك (BankFork) التغييرات في حالة البنك عبر فُتحة (Slot) مُعينة. بمجرد تسجيل العلامة (tick) النهائية، يتم تجميد الحالة. أي مُحاولات للكتابة مرفوضة.

## المُدقّق (validator)

يعمل المُدقّق (validator) على العديد من الإنقسامات أو الشوكات (forks) المُتزامنة المُختلفة لحالة البنك حتى يقوم بإنشاء تجزئة PoH بارتفاع داخل الفُتحة (Slot) الرئيسية الخاصة به.

## قائد الفُتحة (Slot Leader)

يبني قائد الفُتحة (Slot Leader) الكتل (blocks) فوق إنقسام أو شوكة (fork) واحدة فقط، التي صوّت عليها آخر مرة.

## مُسجل PoH أو PoH Recorder

يستخدم قادة الفُتحات (Slot Leaders) والمُدقّقون (validators) مُسجل PoH لتقدير إرتفاع الفُتحة (Slot) ولتسجيل المُعاملات.

### مُسجل PoH عند المُصادقة (validation)

يعمل مُسجل PoH بمثابة VDF بسيط عند التحقق من الصحة. يخبر المُدقّق (validator) عندما يحتاج للتبديل إلى دور قائد الفُتحة (slot leader). في كل مرة يصوت فيها المُدقّق (validator) على إنقسام أو شوكة (fork)، يجب أن يستخدم إنقسام أو شوكة (fork) أحدث تجزئة كُتلة [blockhash](../terminology.md#blockhash) لإعادة زرع VDF. إعادة البذر (Re-seeding) يحل مشكلتين. أولاً، يقوم بمُزامنة VDF الخاص به مع القائد، مما يسمح له بتحديد وقت بدء الفُتحة القائد (leader slot) بشكل أكثر دقة. ثانيًا، إذا تعطل القائد السابق، فسيتم إحتساب كل وقت ساعة الحائط في مجرى PoH للقائد التالي. على سبيل المثال، إذا كانت إحدى الكتل (block) مفقودة عند بدء القائد، فيجب أن يكون للكتلة التي تنتجها مُدة PoH من كتلتين. تضمن المُدة الأطول عدم مُحاولة القائد التالي قص جميع المُعاملات من فُتحة (Slot) القائد السابق.

### مُسجل PoH عند القيادة (validation)

يستخدم قائد الفُتحة مُسجل PoH لتسجيل المُعاملات، ويغلق مواقعهم في الوقت المناسب. تجزئة PoH يجب أن تكون مُشتقة من آخر كتلة (block) لقائد سابق. إذا لم يكن كذلك، فستفشل الكتلة (block) في التحقق من PoH وستُرفض من قبل المجموعة (cluster).

يعمل مُسجل PoH أيضًا على إعلام قائد الفُتحة (Slot Leader) عند إنتهاء الفُتحة (Slot) الخاصة به. يحتاج القائد إلى الحرص على عدم تعديل البنك الخاص به إذا كان تسجيل المُعاملة سيؤدي إلى إنشاء إرتفاع في PoH خارج الفُتحة (Slot) المُخصصة له. لذلك، لا ينبغي للقائد إجراء تغييرات في الحساب إلا بعد أن يقوم بإنشاء مُدخل (entry) تجزئة PoH. عندما يقع إرتفاع PoH خارج الفُتحة (Slot) الخاصة به، فقد يتم إسقاط أي مُعاملات في خط الأنابيب (pipeline) الخاص به أو إعادة توجيهها إلى القائد التالي. يُفضل إعادة التوجيه، لأنه سيُقلل من إزدحام الشبكة، مما يسمح للمجموعة (cluster) بالإعلان عن سعة مُعاملات في الثانية الواحدة (TPS) أعلى.

## حلقة المُدقّق (Validator Loop)

يُدير مُسجل PoH الإنتقال بين الأوضاع. بمجرد إعادة تشغيل دفتر الأستاذ (ledger)، يُمكن تشغيل المُدقّق (validator) حتى يُشير المُسجل إلى أنه يجب أن يكون قائد الفُتحة (slot leader). كقائد الفُتحة (slot leader)، يُمكن للعُقدة (node) بعد ذلك تنفيذ المُعاملات وتسجيلها.

تتم مُزامنة الحلقة مع PoH وتقوم ببدء وإيقاف مُتزامن لوظيفة قائد الفُتحة (Slot Leader). بعد التوقف، يجب أن تجد TVU الخاصة بالمُدقّق (validator) نفسها في نفس الحالة كما لو أن قائدًا مختلفًا قد أرسلها لنفس الكتلة (block). ما يلي هو الترميز المستعار (pseudocode) للحلقة:

1. إستعلم عن جدولة القائد (LeaderScheduler) للفُتحة (Slot) المُخصصة التالية.
2. قم بتشغيل TVU على جميع الإنقسامات أو الشوكات (forks). 1. سترسل TVU الأصوات إلى ما تعتقد أنه "أفضل" إنقسام أو شوكة (fork). 2. بعد كل تصويت، قُم بإعادة تشغيل مُسجل PoH للتشغيل حتى التعيين التالي

   الفُتحة (Slot).

3. عندما يحين الوقت لتكون قائد الفُتحة (Slot Leader)، إبدأ تشغيل TPU. قُم بتوجيهه إلى آخر إنقسام أو شوكة (fork)

   صوت TVU على.

4. قم بإنتاج المُدخلات (entries) حتى نهاية الفُتحة (Slot). 1. طوال مدة الفُتحة (Slot)، يجب ألا تصوت TVU على إنقسامات أو شوكات (forks) أخرى. 2. بعد إنتهاء الفُتحة (Slot)، تجمد TPU الخاصة بها إنقسام أو شوكة البنك (BankFork). بعد التجميد،

   يجوز لـTVU إستئناف التصويت.

5. إذهب إلى 1.
