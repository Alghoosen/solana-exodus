---
title: النظر في التعليمات (instruction introspection)
---

## المُشكل (Problem)

قد ترغب بعض برامج العقود الذكية في التحقق من وجود تعليمة أخرى في رسالة معينة لأن تلك التعليمات يمكن أن تؤدي التحقق من بيانات معينة. في دالة مجمعة مسبقاً. (أُنظر على سبيل المثال secp256k1\_instruction).

## الحل (Solution)

أضف sysvar جديد Sysvar1nstructions1111111111111111111111111 يُمكن للبرنامج الرجوع إليه وإستلام بيانات تعليمات الرسالة بداخله، وكذلك فهرس التعليمات الحالية.

يمكن إستخدام وظيفتي مُساعد لإستخراج هذه البيانات:

```
fn load_current_index(instruction_data: &[u8]) -> u16;
fn load_instruction_at(instruction_index: usize, instruction_data: &[u8]) -> Result<Instruction>;
```

سيتعرف وقت التشغيل على هذه التعليمات الخاصة، ويقوم بتسلسل بيانات تعليمات الرسالة الخاصة بها وأيضًا كتابة فهرس التعليمات الحالي ومن ثم يُمكن لبرنامج bpf إستخراج المعلومات الضرورية من هناك.

ملاحظة: يتم إستخدام التسلسل المُخصص للتعليمات لأن الرمز Bincode يكون أبطأ بمقدار 10x في الكود الأصلي ويتجاوز حدود تعليمات الـ BPF الحالية.
