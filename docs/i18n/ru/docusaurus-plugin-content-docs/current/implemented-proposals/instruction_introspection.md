---
title: анализ инструкций
---

## Проблематика

Некоторым программам смарт-контрактов может понадобиться убелиться, что другая Инструкция присутствует в полученом Сообщении, поскольку эта Инструкция может выполнять проверку определенных данных в предварительно скомпилированной функции. (Пример см. secp256k1_instruction).

## Решение

Используйте системную переменную Sysvar1nstructions1111111111111111111111111 на которую может сослаться программа, чтобы получить данные инструкции внутри сообщения вместе с индексом текущей инструкции.

Для извлечения этих данных можно использовать две вспомогательные функции:

```
fn load_current_index(instruction_data: &[u8]) -> u16;
fn load_instruction_at(instruction_index: usize, instruction_data: &[u8]) -> Result<Instruction>;
```

Среда выполнения распознает эту специальную инструкцию, сериализует для нее данные инструкции внутри Сообщения, а также запишет текущий индекс инструкции, и уже затем программа bpf сможет извлечь оттуда необходимую информацию.

Примечание: поскольку двоичный код примерно в 10 раз медленнее в машинном коде и превышает текущие ограничения инструкций BPF, используется кастомная сериализация инструкций.
