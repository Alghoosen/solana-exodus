---
title: Программа тестирования
---

Приложения отправляют транзакции в кластер Solana и запрашивают валидаторы, чтобы подтвердить, что транзакции были обработаны, и проверить результат каждой транзакции. Когда кластер ведет себя не так, как ожидалось, это может быть по ряду причин:

- Программа имеет ошибку
- Загрузчик BPF отклонил небезопасную программную инструкцию
- Транзакция была слишком большая
- Транзакция была недействительной
- Среда выполнения пыталась выполнить транзакцию, когда другая выполняла доступ

  к тому же аккаунту

- Сеть сбросила транзакцию
- Кластер откатил реестр
- Валидатор злонамеренно ответил на запросы

## AsyncClient и SyncClient признаки

Для устранения неполадок приложение должно перенацелить компонент нижнего уровня, где возможно меньше ошибок. Смена целей может быть выполнена с помощью различных реализаций признаков AsyncClient и SyncClient.

Компоненты реализуют следующие основные методы:

```text
trait AsyncClient {
    fn async_send_transaction(&self, transaction: Transaction) -> io::Result<Signature>;
}

trait SyncClient {
    fn get_signature_status(&self, signature: &Signature) -> Result<Option<transaction::Result<()>>>;
}
```

Пользователи отправляют транзакции и асинхронно и синхронно ожидают результатов.

### ThinClient для кластеров

Реализация самого высокого уровня, ThinClient, нацелена на кластер Solana, который может быть развернутой тестовой сетью или локальным кластером, работающим на машине разработки.

### TpuClient для TPU

Следующим этапом является реализация TPU, которая еще не реализована. На уровне TPU приложение отправляет транзакции по каналам Rust, где не может быть сюрпризов от сетевых очередей или отброшенных пакетов. TPU реализует все «нормальные» ошибки транзакций. Он выполняет проверку подписи, может сообщать об ошибках в использовании аккаунта и, в противном случае, приводит к созданию реестра с подтверждением хэшей истории.

## Low-level тестирование

### BankClient для банка

Ниже уровня TPU находится банк. Банк не выполняет проверку подписи и не создает реестр. Банк - это удобный уровень для тестирования новых сетевых программ. Это позволяет разработчикам переключаться между реализациями собственных программ и вариантами, скомпилированными в формате BPF. Здесь нет необходимости в признаках Transact. API банка синхронное.

## Тестирование модулей с Runtime

Ниже банка находится среда выполнения. Runtime - идеальная тестовая среда для модульного тестирования. Статически связывая среду выполнения с собственной реализацией программы, разработчик получает самый короткий цикл редактирования-компиляции-выполнения. Без какой-либо динамической компоновки трассировки стека включают символы отладки, а программные ошибки легко устранять.
