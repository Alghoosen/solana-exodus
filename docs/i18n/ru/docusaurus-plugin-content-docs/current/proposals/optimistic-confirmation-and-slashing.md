---
title: Оптимистическое Подтверждение и Снятие
---

Прогресс в оптимистическом подтверждении можно отследить здесь

https://github.com/solana-labs/solana/projects/52

В конце мая бета-версия основной сети переходит на 1.1, а тестовая - на 1.2. В версии 1.2 тестовая сеть будет вести себя так, как если бы она была оптимистичной, пока не более 4,66% валидаторов действуют злонамеренно. Приложения могут предполагать, что 2/3 + голосов, наблюдаемых в сплетнях, подтверждают блокировку или что как минимум 4,66% сети нарушают протокол.

## Как это работает?

Общая идея состоит в том, что валидаторы должны продолжать голосование после своего последнего форка, если только валидатор не сможет построить доказательство того, что их текущий форк может не достичь окончательного результата. Валидаторы создают это доказательство, собирая голоса за все вилки, за исключением своей собственной. Если набор действительных голосов составляет более 1/3 + X от веса ставки эпохи, возможно, у текущей вилки валидаторов не будет способа достичь 2/3 + окончательности. Валидатор хеширует доказательство (создает свидетеля) и отправляет его, проголосовав за альтернативный форк. Но если 2/3 + голосуют за один и тот же блок, ни один из валидаторов не может построить это доказательство, и, следовательно, ни один валидатор не может переключать вилки, и этот блок в конечном итоге будет завершен.

## Компромиссы

Запас безопасности составляет 1/3 + X, где X представляет собой минимальную сумму ставки, которая будет уменьшена в случае нарушения протокола. Компромисс в том, что живучесть теперь уменьшается в 2 раза в худшем случае. Если более 1/3 - 2X сети недоступны, сеть может остановиться и возобновить завершение блоков только после того, как сеть восстановит менее 1/3 - 2X отказавших узлов. До сих пор мы не наблюдали большого количества случаев недоступности в нашей сети, космосе или tezos. Для нашей сети, которая в основном состоит из систем высокой доступности, это кажется маловероятным. В настоящее время мы установили пороговый процент на 4,66%, что означает, что в случае сбоя 23,68% сеть может прекратить завершение блоков. Для нашей сети, которая в основном состоит из систем высокой доступности, снижение доступности на 23,68% кажется несвязанным. Шансы 1:10 ^ 12 при условии, что пять узлов с ставкой 4,7% и время безотказной работы 0,995.

## Безопасность

Долгосрочное среднее количество голосов на слот составило 670 000 000 голосов / 12 000 000 слотов, или 55 из 64 валидаторов голосования. Сюда входят пропущенные блоки из-за сбоев производителя блоков. Когда клиент видит 55/64 или ~ 86% подтверждения блока, он может ожидать, что ~ 24% или ` (86 - 66.666.. + 4.666..)% ` сети должно быть сокращено, чтобы этот блок не прошел полную финализацию.

## Почему Solana?

Этот подход может быть построен в других сетях, но реализация сложность значительно снижена на Solana, потому что наши голоса имеют доказуемые таймауты на основе VDF. Неясно, можно ли легко построить доказательства переключения в сетях со слабыми предположениями о времени.

## Дорожная карта Снятия

Снятия - сложная проблема, и она становится еще труднее, когда целью сети является минимально возможная задержка. Компромиссы особенно очевидны при оптимизации задержки. Например, в идеале валидаторы должны отдавать и распространять свои голоса до того, как память будет синхронизирована с диском, а это означает, что риск повреждения локального состояния намного выше.

По сути, наша цель - сократить 100% в тех случаях, когда узел злонамеренно пытается нарушить правила безопасности и 0% при рутинной работе. Мы стремимся достичь этого, чтобы сначала внедрить доказательства снятия без какого-либо автоматического отсечения.

Прямо сейчас, для регулярного консенсуса, после нарушения безопасности сеть остановится. Мы можем проанализировать данные и выяснить, кто был ответственный и предлагает сократить ставку после начать сначала. Аналогичный подход будет использован с оптимистичной конф. Оптимистичное нарушение безопасности легко заметить, но под при нормальных обстоятельствах оптимистичное подтверждение нарушения безопасности не может остановить работу сети. Оптимистичное нарушение безопасности легко заметить, но под при нормальных обстоятельствах оптимистичное подтверждение нарушения безопасности не может остановить работу сети.

В долгосрочной перспективе транзакции должны иметь возможность вернуть часть снятого залога, если оптимистичное нарушение безопасности доказано. В этом сценарии каждый блок эффективно застрахован сеть.
