---
title: Анатомия валидатора
---

![Диаграмма блоков валидатора](/img/validator.svg)

## Конвейерная обработка

Валидаторы широко используют обычную оптимизацию для ЦП, называемую _pipelining_ (конвеерная обработка). Pipelining является подходящим инструментом для задач, в которых поток входных данных должен обрабатываться последовательностью шагов, и есть различные устройства ответственные за каждый. Типичным примером является использование стиральной машины и сушилки для стирки/сушки/складирования нескольких партий белья. Стирка должна производиться перед сушкой, а сушка перед складыванием, но каждая из трех операций выполняется отдельным блоком. Для увеличения эффективности создается pipeline из _этапов_. Мы назовем стиральную машину одним этапом, сушилку - другим, а процесс складывания - третьим. Чтобы запустить pipeline, в стиральную машину добавляют вторую загрузку белья сразу после того, как в сушилку добавляется первая загрузка. Точно так же третья загрузка добавляется в стиральную машину после того, как вторая окажется в сушилке, а первая складывается. Таким образом, можно одновременно обрабатывать три загрузки белья. При бесконечных нагрузках pipeline будет последовательно завершать загрузку со скоростью самой медленной стадии в pipeline.

## Конвейерная обработка у валидаторов

Валидатор содержит два конвейерных процесса, один из которых используется в режиме лидера, называемый TPU, а другой - в режиме валидатора, называемый TVU. В обоих случаях оборудование в pipeling одинаковое: сетевой вход, графические карты GPU, ядра CPU, записи на диск и сетевой вывод. А то, что он делает с этим оборудованием, отличается. TPU существует для создания записей в реестре, тогда как TVU существует для их проверки и валидации.
