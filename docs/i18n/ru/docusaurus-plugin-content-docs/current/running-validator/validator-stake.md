---
title: Стейкинг
---

**По умолчанию у вашего валидатора нет стейка.** Это означает, что он не имеет права стать лидером.

## Мониторинг Catch Up

Для делегирования необходимо сначала убедиться, что ваш валидатор запущен и синхронизирован с кластером. Это может занять некоторое время после загрузки валидатора. Используйте команду `catchup`, чтобы отслеживать синхронизацию:

```bash
solana catchup ~/validator-keypair.json
```

До тех пор, пока ваш валидатор не синхронизируется, он не сможет голосовать и стейк не может быть ему делегирован.

Также если вы обнаружите, что слот кластера двигается быстрее, чем ваш, вы, скорее всего, никогда не сможете синхронизироваться с блокчейном. Обычно это подразумевает какие-либо проблемы между вашим валидатором и остальным кластером.

## Создание Stake аккаунта

Если вы еще не сделали этого, создайте staking keypair. Если вы завершили этот шаг, вы должны увидеть «validator-stake-keypair.json» в рабочей папке Solana.

```bash
solana-keygen new -o ~/validator-stake-keypair.json
```

## Делегирование стейка

Теперь делегируйте 1 SOL вашему валидатору, создав сначала учетную запись для вашей ставки:

```bash
solana create-stake-account ~/validator-stake-keypair.json 1
```

а затем делегируйте этой стейк вашему валидатору:

```bash
solana delegate-stake ~/validator-stake-keypair.json ~/vote-account-keypair.json
```

> Не делегируйте все оставшиеся SOL, так как ваш валидатор будет использовать их для голосования.

Стейки могут быть переделегированы на другой узел в любое время той же командой, но для каждой эпохи разрешено только одно повторное делегирование:

```bash
solana delegate-stake ~/validator-stake-keypair.json ~/some-other-vote-account-keypair.json
```

Если ваша стейк делегирован, то теперь вы генерируете награды. Награды выплачиваются автоматически на границе эпохи.

Заработанные lamports разделяются на ваш стейк и vote аккаунт в соответствии с комиссией, установленной на vote аккаунте. Награды могут быть получены только во время работы валидатора. Далее валидатор, после того как он запущен, становится важной частью сети. Чтобы безопасно остановить валидатора, сначала деактивируйте его стейк.

В конце каждого слота ожидается, что валидатор отправит vote транзакцию. Vote транзакции оплачивается lamports из учетной записи валидатора.

Это обычная транзакция, поэтому будет взиматься стандартная комиссия за транзакцию. Диапазон транзакционных комиссий определяется блоком генезиса. Фактическая комиссия будет колебаться в зависимости от загрузки сети. Вы можете определить текущую комиссию через [RPC API “getRecentBlockhash”](developing/clients/jsonrpc-api.md#getrecentblockhash) перед отправкой транзакции.

Подробнее о [трансакционных сборах можно узнать здесь](../implemented-proposals/transaction-fees.md).

## Разогрев стейка

Для борьбы с различными атаками на консенсус, новые делегации должны быть "разогреты" [](/staking/stake-accounts#delegation-warmup-and-cooldown).

Отслеживать разогрев стейка можно следующим образом:

- Просмотр vote аккаунта: `solana vote-account ~/vote-account-keypair.json` Это отображает текущее состояние всех голосов, переданных валидатором в сеть.
- Просмотр stake аккаунта, делегации и детали вашего стейка: `solana stake-account ~/validator-stake-keypair.json`
- `solana валидаторы` отображает текущий активный стейк всех валидаторов, включая вас
- `соляная история` показывает историю стейкинга, который разогревался и охлаждался в прошлых эпохах
- Ищите сообщения журнала на вашем валидаторе с указанием вашего следующего лидера слота: `[2019-09-27T20:16:00.319721164Z INFO solana_core::replay_stage] <VALIDATOR_IDENTITY_PUBKEY> voted and reset PoH at tick height ####. My next leader slot is ####`
- Как только ваша ставка разогреется, вы увидите баланс, указанный для вашего валидатора, запустив `solana validators`

## Мониторинг валидатора с вашим стейком

Подтвердите, что ваш валидатор становится [лидером](../terminology.md#leader)

- После того, как ваш валидатор синхронизирован, используйте команду `solana balance` для мониторинга заработок по мере того, как ваш валидатор выбирается в качестве лидера и собирает транзакционные комиссии
- Узлы Solana предлагают ряд полезных методов JSON-RPC для возврата информации о сети и участии вашего валидатора. Сделайте запрос с помощью curl \(или другого клиента http по вашему выбору\), указав нужный метод в данных, отформатированных в JSON-RPC. Например:

```bash
  // Request
  curl -X POST -H "Content-Type: application/json" -d '{"jsonrpc":"2.0","id":1, "method":"getEpochInfo"}' http://localhost:8899

  // Result
  {"jsonrpc":"2.0","result":{"epoch":3,"slotIndex":126,"slotsInEpoch":256},"id":1}
```

Полезные методы JSON-RPC:

- `getEpochInfo`[ Эпоха](../terminology.md#epoch) это время, т.е. количество [слотов](../terminology.md#slot), для которых [leader schedule](../terminology.md#leader-schedule) является действительным. Это покажет, какая сейчас текущая эпоха и насколько далеко она находится в кластере.
- `getVoteAccounts` Это значение отобразит, насколько активна ваша ставка в настоящее время. На границе эпохи активируется % от ставки валидатора. Вы можете узнать больше о стейкинге Solana [здесь](../cluster/stake-delegation-and-rewards.md).
- `getLeaderSchedule` В любой конкретный момент времени сеть ожидает, что только один валидатор будет производить запись в блокчейне. Валидатор, [ который в настоящее время выбран для создания записей в блокчейне](../cluster/leader-rotation.md#leader-rotation) называется «лидер». Это значение отобразит весь график лидера\(на основе слота\) для текущего активного стейка, идентификационный ключ будет отображаться здесь 1 или более раз.

## Деактивация стейка

Перед тем как вывести валидатора из кластера, вы должны деактивировать стейк, который ранее была делегирован следующим образом:

```bash
solana deactivate-stake ~/validator-stake-keypair.json
```

Деактивация стейка не происходит немедленно и охлаждается также, как и разогревается. Ваш валидатор должен подключенным и синхронизированным с кластером, в то время как стейк охлаждается. Остывая, ваша ставка будет продолжать получать вознаграждение. Только после полного остывания ставки можно безопасно отключить валидатор или вывести его из сети. Остывание может занять несколько эпох, в зависимости от активного стейка сети и размера вашего стейка.

Обратите внимание, что стейк аккаунт может использоваться только один раз, поэтому после деактивации используйте команду вывода `withdraw-stake`.
