---
title: バリデータ
---

## 歴史

Solanaを立ち上げた当初の目的は、TPSの主張のリスクをなくすことでした。 楽観的な同時性制御と十分に長いリーダースロットの間では、PoSコンセンサスがTPSの最大のリスクではないことがわかっていました。 それは、GPUベースの署名検証、ソフトウェアのパイプライン化、コンカレントバンキングでした。 こうして、TPUが誕生しました。 PSが100kを超えた後、チームを710k TPSを目指すグループと、バリデータのパイプラインを具体化するグループに分けました。 そして、TVUが誕生したのです。 現在のアーキテクチャは、このような順序とプロジェクトの優先順位で段階的に開発を進めた結果です。 これらの技術の中で最も技術的に優れていると考えられていたものを反映したものではありません。 リーダーローテーションの文脈では、リーディングとバリデーションの強い区別が曖昧になっています。

## 検証とリードの違い

パイプラインの根本的な違いは、PoHが存在する場合です。 リーダでは、トランザクションを処理して悪いものを取り除き、その結果にPoHのハッシュを付けます。 バリデータでは、そのハッシュを検証し、それを剥がし、まったく同じ方法でトランザクションを処理します。 唯一の違いは、バリデータが不正なトランザクションを見つけた場合、リーダのように単純に削除することはできません。 その代わりに、ブロック全体を拒否します。 パイプラインのもう一つの違いは、銀行業務の_後_に起こることです。 リーダは下流のバリデータにエントリをブロードキャストするが、バリデータは"RetransmitStage"ですでに行っているので、確認時間の最適化になります。 一方、検証パイプラインには最後のステップがあります。 ブロックの処理が終わったら、観察しているフォークを調べ、場合によっては投票を行い、投票が行われた場合にはPoHハッシュを投票したばかりのブロックハッシュにリセットする必要があります。

## 提案されたデザイン

私たちは、多くの抽象化されたレイヤーを解きほぐし、バリデータのIDがリーダのスケジュールに表示されるたびに、リーダモードをオンにすることができる単一のパイプラインを構築します。

![Validator block diagram](/img/validator-proposal.svg)

## 注目すべき変更

- "FetchStage"と"BroadcastStage"のTPUからの引き上げ
- "BankForks" を "Banktree" に改名
- TPUは"solana-tpu"という新しいソケットフリーのクレートに移動
- TPUの"BankingStage"が"ReplayStage"を吸収します
- TVUがなくなります
- 新しい"RepairStage"は、"Shred Fetch Stage"と修理依頼を吸収します。
- "JSON RPCサービス"はオプションで、デバッグのために使用されます 代わりに別の`"solana-blockstreamer"`実行ファイルの一部にする必要があります。
- 新しい"MulticastStage"は"RetransmitStage"の再送部分を吸収します
- ブロックストアの下流にある"MulticastStage"
