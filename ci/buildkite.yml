# Build steps that run on pushes and pull requests.
#
# Release tags use buildkite-release.yml instead
steps:
  - wait
  - command: "RUST_LOG=solana=info cargo +1.37.0 test test_fail_entry_verification_leader  --test local_cluster -- --nocapture --test-threads 1"
    name: "local_cluster"
    timeout_in_minutes: 40
    artifact_paths: "log-*.txt"
  # TODO: Fix and re-enable test-large-network.sh
  # - command: "ci/test-large-network.sh || true"
  #   name: "large-network [ignored]"
  #   timeout_in_minutes: 20
  #   agents:
  #     - "queue=large"
  - wait
  - trigger: "solana-secondary"
    branches: "!pull/*"
    async: true
    build:
      message: "${BUILDKITE_MESSAGE}"
      commit: "${BUILDKITE_COMMIT}"
      branch: "${BUILDKITE_BRANCH}"
      env:
        TRIGGERED_BUILDKITE_TAG: "${BUILDKITE_TAG}"
